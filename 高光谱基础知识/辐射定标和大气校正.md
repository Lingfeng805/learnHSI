# 高光谱图像处理

- **数据预处理**+**数据分析**

- **图像分割、归一化、滤波、特征提取、分类识别 ** 五大环节
  - **图像分割**：从图像中把若干特定的、具有相同特征的区域分割提取出来的技术和过程；
- **光谱数据预处理**：光谱异常筛选、光谱平滑去噪、光谱重采样、光谱变换、光谱定量化计算；

# 辐射定标和大气校正

## 1.概述

​    太阳辐射通过大气以某种方式入射到物体表面然后再反射回传感器，由于大气气溶胶、地形和邻近地物等影像，使得原始影像包含物体表面，大气，以及太阳的信息等信息的综合。如果我们想要了解某一物体表面的光谱属性，我们必须将它的反射信息从大气和太阳的信息中分离出来，这就需要进行大气校正过程。

​    利用ENVI 大气校正扩展模块（FLAASH和QUAC）对多光谱和高光谱数据进行大气校正的过程，还包括大气校正的准备工作——辐射定标。

​    FLAASH是基于MODTRAN5辐射传输模型，MODTRAN模型是由进行大气校正算法研究的领先者SpectralSpectral Sciences, Inc和美国空军实验室（Air Force Research Laboratory）共同研发。Exelis VIS公司负责集成和GUI设计。

## 2.辐射定标

​    一般来讲，辐射定标就是将图像的数字量化值（DN）转化为辐射亮度值或者反射率或者表面温度等物理量的处理过程。辐射定标即通过分析遥感器辐射响应特点，建立相应数学模型，可以将遥感器入瞳处的输入辐射物理量值和输出数字计数值之间进行定量转化。

![1](E:/software/Typora/pictures/1.bmp)

一个完整的**遥感过程**包含地物目标电磁波信息获取、存储与传输、接收与处理、分析与应用。

# 3.目标检测

​    传统的目标检测主要基于**空间维**的处理技术，高光谱图像目标检测侧重于基于**光谱维**分析的处理技术，形态信息在高光谱图像目标检测中的作用微乎其微。高光谱图像数据获取过程中很难同时提高**光谱分辨率**和**空间分辨率**。高光谱**像元**光谱曲线中包含了目标的**诊断性光谱特征**，可用于目标的光谱识别。

- 主要依赖于**光谱信息特征性检测地物目标**，对空间信息依赖不大；
- 主要方法：**光谱特征分析**、**光谱相似度量**、**混合像元分解**、**光谱匹配**；

## 监督和非监督

- 监督：目标光谱已知，可利用已知的目标光谱与图像像元光谱进行匹配完成目标检测，采用的主要方法包括：
  - 光谱距离统计
    - 欧式距离(Euclidean Distance, ED)
    - 光谱角匹配 (Spectral Angle Mapper, SAM)
    - 光谱信息散度 (Spectral Information Divergence, SID)
    - 互相关光谱匹配 (Cross Correlogram Spectral Matching, CCSM)
    - 二值编码匹配 (Binary Coding Match, BCM)[93] 
    - 光谱吸收特征匹配 (Spectral Absorption Feature Matching, SAFM)
  - 影响因素：
    - 监督算法中目标先验知识主要来源于**光谱数据库**，而光谱数据库中的数据一般采用野外测量的方法获得，这就使得测量的光谱与图像光谱存在**差异**；
    - 地物光谱存在**不确定性**，即**同物异谱、异物同谱**现象，如，图像中同一种目标光谱特征受观测几何、光照、大气、背景环境、仪器噪声等影响，图像目标光谱有可能与光谱数据库的目标光谱曲线有很大差异，从而影响检测结果；
    - 在进行**光谱匹配识别**前需要对图像数据进行**定标**和**反射率转换**，该处理会产生一定的**误差**，也对目标检测结果产生很大的影响；

## 高光谱图像目标检测关键问题

- **光谱不确定性**：地物真实测量的光谱反射率数据是随着外界环境不断变化的，不同时刻对同一地物测量的光谱特性是不同的；——由于光谱不确定性的存在，使得目标不能用唯一的光谱曲线进行标识。

- **数据冗余与波段降维**：数据相邻波段之间的**相关性非常高**，因此数据冗余；——**降维**：用较少的**特征变量**代表原来的全部高光谱数据而没有信息损失或尽可能的减少信息损失。**波段降维、特征提取**（但对于**异常检测**来说，由于异常目标的出现概率非常低，在特征空间中对应于小特征范围，很容易被看作是噪声而舍弃，因此传统的数据降维技术难免存在一定的局限性。）
- **混合像元与端元提取**：每个像元的光谱曲线是该像元覆盖面积内所有地物光谱综合作用的结果。**纯像元**：对于某个特定像元，像元空间范围内仅包含一种地物光谱；**混合像元**：像元空间范围内包含多种地物信息；高光谱遥感往往不具有较高的空间分辨率，使得感兴趣目标有可能是以**亚像元**的形式存在，因此通过混合像元分解使目标检测由像元级达到亚像元级可以提高目标检测的精度；
- **低概率出露目标**：理想的高光谱目标检测情况是—高光谱遥感器获取的图像不含噪声且不受大气等因素干扰，具有无限高的空间分辨率，可分别从图像空间、光谱空间和特征空间对目标进行检测和识别；然而，实际情况—遥感器的空间分辨率与光谱分辨率**相互制约**，目前高光谱遥感的空间分辨率低。但在足够高的光谱分辨率条件下，感兴趣目标会表现出**诊断性**光谱特征或者会在背景地物中显示为一种**数据异常**，利用这些信息可将**亚像元**级别目标或者**小存在概率**目标提取出来；

## 目标检测流程

- 目标检测：通过**检测门限（或检测阈值）**来判定待检测点是否为目标；

- 原始高光谱数据—预处理（数据格式化、坏点修复、波段配准、无用数据剔除等）—辐射校正

![image-20210723162810482](E:/software/Typora/pictures/image-20210723162810482.png)

## 目标检测性能评价

- **主观评价**：主要由人眼视觉感应决定，可作为算法性能评价的参考，但受主观影响因素较大，不客观；

- **客观评价**：通过一定的准则或可以量化的指标对目标检测算法进行分析，以评价算法的优劣性；**检测概率、虚警概率、信杂比、算法时间、ROC曲线特性**

  - 1.较高的目标检测率；
  - 2.较低的虚警概率；
  - 3.在保证目标被检测的前提下，最大程度抑制背景信息；
  - 4.在给定统计模型条件下具备恒虚警率操作特性；
  - 5.在不同场景、不同传感器平台下检测效果的鲁棒性；
  - 6.算法的时间复杂度；

- **检测率和虚警率**：判断图像每个像元是否正确判定的重要指标。

  - **检测概率$P_d$**:检测到的真实目标像素与实际目标像素总数的比值，

  - **虚警概率$P_f$**：检测到的虚警像素与整幅图像像素总数的比值；

    - **$P_d=\frac{N_d}{N_t}$**
    - **$P_f=\frac{N_f}{N_{total}}$**

    **$N_d$**为在某个特定分割阈值下检测到的目标像元数目；

    **$N_t$**为真实地物分布中所有目标像元的总数目；

    **$N_f$**为错分成目标的背景像元数目；

    **$N_{total}$**为高光谱图像中所有像元数目的总和。

- **算法复杂度和运行时间**：

- **ROC曲线分析**：接收机特性曲线（Receiver Operating Characteristic），横轴：虚警概率$P_f$​​，纵轴:检测概率$P_d$​​​；

  - 当曲线越靠近ROC方框区域的左上角，它的性能越好；
  - AUCROC：计算曲线的下面积大小，取值范围 [0.5,1]，对检测概率和虚警概率ROC曲线，其值越接近1表明目标检测算法性能越好；对虚警概率和检测阈值ROC曲线，其值越小表明检测算法对背景抑制的越好。

## 基于像元递归的高光谱实时目标检测

- RX算子：通过比较当前观测点与背景统计信息差异大小来判决其属于目标还是背景，无需先验信息；对于每个待测像元，现有RX算子均需重复计算样本均值及协方差来进行异常性分析，**计算量较大**；
  - RZ算子通过计算当前观测点与所选背景光谱的马氏距离进行目标检测与识别；

